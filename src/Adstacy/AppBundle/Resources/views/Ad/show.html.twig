{% extends 'AdstacyAppBundle::layout.html.twig' %}

{% block title %}{{ ad.description }} | Adstacy{%endblock %}

{% block meta_keywords %}{{ ad.tags|join(',') }}{% endblock %}

{% block facebook_scripts %}
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1&appId=138676862997429";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
{% endblock %}

{% block content %}
  {% set wall = ad.wall %}
  {% set user = wall.user %}
  <div class="ad-single">
    {% if app.user == user %}
      <a href="{{ path('adstacy_app_ad_edit', {id: ad.id}) }}" class="btn btn-primary">Edit</a>
      <a href="#" data-toggle="modal" data-target="#confirm-modal" class="btn btn-primary btn-log">Delete</a>
    {% endif %}
    <a href="https://twitter.com/share" class="twitter-share-button" data-related="adstacy">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
    <div class="fb-like" data-width="450" data-show-faces="false" data-send="false"></div>

    <p>{{ parse_hashtag(ad.description) }} ({{ ad.promoteesCount }}) promotes</p>
    <a class="btn btn-primary btn-wall" href="{{ path('adstacy_app_wall_show', {id: ad.wall.id}) }}">{{ ad.wall.name }}</a>
    <img src="{{ vich_uploader_asset(ad.image, 'file') }}" alt="{{ ad.description }}">
    <div class="ad-content">
      {{ ad.content }}
    </div>
    <h3>{{ user.username }}</h3>
    {% include 'AdstacyAppBundle:Wall:follow_button.html.twig' with {wall: wall} %}

  </div>
  <div class="modal fade" id="confirm-modal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title">Delete Confirmation</h4>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete this ads?</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <a href="{{ path('adstacy_app_ad_delete', {id: ad.id}) }}" class="btn btn-primary">DELETE!</a>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block javascripts %}
  {{ parent() }}
  <script type="text/javascript">
    $(function() {
      $('.ad-single').ajaxlink('show_ad');
    });
  </script>
{% endblock %}
