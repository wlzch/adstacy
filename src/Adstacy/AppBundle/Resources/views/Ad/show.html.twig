{% extends 'AdstacyAppBundle::layout.html.twig' %}

{% block title %}{{ ad.description }} | Adstacy{%endblock %}

{% block meta_keywords %}{{ ad.tags|join(',') }}{% endblock %}

{% block stylesheets %}
  {{ parent() }}
  {% if app.debug %}
    <link href="{{ asset('bundles/adstacyapp/css/jquery.fancybox.min.css') }}" type="text/css" rel="stylesheet" />
  {% else %}
    <link href="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css" rel="stylesheet" />
  {% endif %}
{% endblock %}

{% block content %}
  {% set user = ad.user %}

  <div class="ad-detail-container" style="width: 750px; margin: auto;">
    <div class="clearfix">
      <div class="ad-detail-pic centered pull-left" style="width: 500px;">
        <div class="inline-block">
          <a class="w25 block-item btn-gray">{{ ad.promoteesCount }} promotes</a>
          <a href="{{ path('adstacy_app_ad_unpromote', {id: ad.id}) }}" class="block-item w25 btn-success unpromote hide">
            <span aria-hidden="true" class="icon-bullhorn"></span> Unpromote
          </a>
          <a href="{{ path('adstacy_app_ad_promote', {id: ad.id}) }}" class="block-item w25 btn-primary promote">
            <span aria-hidden="true" class="icon-bullhorn"></span> Promote
          </a>
          <a href="{{ app.request.uri }}" class="tweet block-item w25 btn-twitter" data-via="adstacy" data-text="{{ ad.description }}">
            <span aria-hidden="true" data-icon="&#xe002;"></span> Tweet
          </a>
          <a href="{{ app.request.uri }}" class="facebook-share block-item w25 btn-facebook">
            <span aria-hidden="true" data-icon="&#xe003;"></span> Share
          </a>
        </div>
        <div class="ad-detail-picture vertical-image">
          {% set src = vich_uploader_asset(ad.image, 'file') %}
          <a class="fancybox" href="{{ src }}"><img src="{{ src }}" alt="{{ ad.description }}" /></a>
        </div>
      </div>
      <div class="ad-detail-detail pull-left" style="width: 250px;">
        <div class="ad-detail-section">
          <p>{{ parse_hashtag(ad.description) }}</p>
        </div>
        <div class="ad-detail-section">
        {% if app.user == user %}
          <div class="ad-detail-section h-stack h-stack-pad">
            <a href="{{ path('adstacy_app_ad_edit', {id: ad.id}) }}" class="stack-item w5 btn btn-primary">Edit</a>
            <a href="#" data-toggle="modal" data-target="#confirm-modal" class="stack-item w5 btn btn-primary">Delete</a>
          </div>
        {% endif %}
      </div>
    </div>
    {% if ad.content %}
      <div class="ad-detail-content">
        {{ ad.content }}
      </div>
    {% endif %}
  </div>
  <div class="modal fade" id="confirm-modal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title">Delete Confirmation</h4>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete this ads?</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <a href="{{ path('adstacy_app_ad_delete', {id: ad.id}) }}" class="btn btn-primary">DELETE!</a>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block javascripts %}
  {{ parent() }}
  {% if app.debug %}
    <script src="{{ asset('bundles/adstacyapp/js/jquery.fancybox.min.js') }}" type="text/javascript"></script>
  {% else %}
    <script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js" type="text/javascript"></script>
  {% endif %}
  <script type="text/javascript">
    $(function() {
      $('.ad-single').ajaxlink('show_ad');
      $('.fancybox').fancybox();
    });
  </script>
{% endblock %}
