{% extends is_ajax() ? '::ajax.html.twig' : 'AdstacyAppBundle:User:show.html.twig' %}

{% block show_content %}
  {% if paginator.getCurrentPageResults|length > 0 %}
    <div class="masonry jscroll">
      {{ block('ajax_content') }}
    </div>
  {% else %}
    <div class="jumbotron text-center">
      <h1>{{"ads.no_ads.message"|trans}}</h1>
      <p class="lead">{{"ads.no_ads.help"|trans}}</p>
      <a href="{{ path('adstacy_app_ad_create') }}" class="btn-group btn-group-lg">
        <span class="btn btn-success"><span class="icon-plus"></span></span>
        <span class="btn btn-success">{{"ads.create"|trans}}</span>
      </a>
    </div>
  {% endif %}
{% endblock %}

{% block ajax_content %}
  {% for ad in paginator.getCurrentPageResults %}
    {% include 'AdstacyAppBundle:Ad:ad.html.twig' with {ad: ad, user: user} %}
  {% endfor %}
  {% if paginator.hasNextPage %}
    {% set params = app.request.query.all|merge({username: user.username, page: paginator.getNextPage}) %}
    <a href="{{ path(route, params )}}" class="btn btn-lg btn-default btn-block next-page">{{"more"|trans}}</a>
  {% endif %}
{% endblock %}

{% block javascripts %}
  {{ parent() }}
  <script type="text/javascript">
    $(function() {
      $('.jscroll').jscroll({
        nextSelector: 'a.next-page',
        callback: function(a, b) {
          var $ads = $('.jscroll-added:last .ad');
          $masonry = $('.masonry').masonry('appended', $ads);
          $ads.find('img.lazy').lazyload();
          $ads.find('.ad-social').ajaxlink('ads');
          $ads.find('[data-toggle="tooltip"]').tooltip();
        }
      });
    });
  </script>
{% endblock %}
