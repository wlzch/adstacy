{% extends 'AdstacyAppBundle::layout.html.twig' %}

{% block title %}{{ wall.name }} | Adstacy{% endblock %}

{% block meta_keywords %}{{ wall.tags|join(',') }}{% endblock %}

{% block stylesheets %}
  {{ parent() }}
  {% stylesheets filter='cssrewrite, uglifycss'
    'bundles/adstacyuser/less/settings.less'
  %}
    <link href="{{ asset_url }}" type="text/css" rel="stylesheet">
  {% endstylesheets %}
{% endblock %}

{% block content %}
  {% set user = app.user %}
  <div class="masonry-container">
    <div class="show-wall-container adstacy-container panel panel-default">
      <div class="clearfix">
        <div class="pull-left">
          <h2 class="wall-name">{{ wall.name }}
            {% include 'AdstacyAppBundle:Wall:follow_button.html.twig' with {wall: wall} %}
            {% if wall.user == user %}
              <a class="btn" href="{{ path('adstacy_app_wall_edit', {id: wall.id})}}">Edit</a>
              <a class="btn" data-target="#confirm-modal" data-toggle="modal">Delete</a>
            {% endif %}
          </h2>
          {% include 'AdstacyAppBundle:User:user_mini.html.twig' with {user: user} %}
        </div>
        <div class="pull-right">
          <div class="score-count">
            <p class="label">Followers</p>
            <p class="value followers-count">{{ wall.followersCount }}</p>
          </div>
          <div class="score-count">
            <p class="label">Ads</p>
            <p class="value">{{ wall.adsCount }}</p>
          </div>
        </div>
      </div>
      {% if wall.description %}
        <h3 class="description">{{ parse_hashtag(wall.description) }}</h3>
      {% endif %}
    </div>
  </div>
  <div class="masonry">
  {% for ad in wall.ads %}
    {% include 'AdstacyAppBundle:Ad:ad.html.twig' with {ad: ad} %}
  {% endfor %}
  </div>
  <div class="modal fade" id="confirm-modal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title">Delete Confirmation</h4>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete this wall? ALL ADS WITHIN THIS WALL WILL ALSO BE DELETED</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <a href="{{ path('adstacy_app_wall_delete', {id: wall.id}) }}" class="btn btn-primary">DELETE!</a>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block javascripts %}
  {{ parent() }}
  <script type="text/javascript">
    $('.show-wall-container').ajaxlink('show_wall');
  </script>
{% endblock %}
